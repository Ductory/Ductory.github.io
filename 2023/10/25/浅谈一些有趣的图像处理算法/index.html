<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>浅谈一些有趣的图像处理算法 | Ductory</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="本文将简要地介绍一些有趣的图像处理算法，包括幻影坦克、无影坦克和图像抖动。">
<meta property="og:type" content="article">
<meta property="og:title" content="浅谈一些有趣的图像处理算法">
<meta property="og:url" content="https://ductory.github.io/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/index.html">
<meta property="og:site_name" content="Ductory">
<meta property="og:description" content="本文将简要地介绍一些有趣的图像处理算法，包括幻影坦克、无影坦克和图像抖动。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://ductory.github.io/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/s.jpg">
<meta property="og:image" content="https://ductory.github.io/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/h.jpg">
<meta property="og:image" content="https://ductory.github.io/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/rgb.png">
<meta property="og:image" content="https://ductory.github.io/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/lab.png">
<meta property="og:image" content="https://ductory.github.io/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/duck.jpg">
<meta property="og:image" content="https://ductory.github.io/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/bin.png">
<meta property="og:image" content="https://ductory.github.io/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/bayer.png">
<meta property="og:image" content="https://ductory.github.io/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/fs.png">
<meta property="og:image" content="https://ductory.github.io/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/fs2.png">
<meta property="og:image" content="https://ductory.github.io/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/fs3.png">
<meta property="article:published_time" content="2023-10-25T02:44:44.000Z">
<meta property="article:modified_time" content="2024-03-30T15:52:49.878Z">
<meta property="article:author" content="Dangfer">
<meta property="article:tag" content="C">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ductory.github.io/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/s.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Ductory" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js" crossorigin="anonymous"></script>

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Ductory</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://ductory.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-浅谈一些有趣的图像处理算法" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/" class="article-date">
  <time class="dt-published" datetime="2023-10-25T02:44:44.000Z" itemprop="datePublished">2023-10-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      浅谈一些有趣的图像处理算法
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><ol>
<li><p>本人并非相关专业，写的东西也并非专业的内容，仅作科普。可能会有错误和纰漏，还请指正。本文更注重于原理讲解和现象分析，而不会在意具体实现。因为当你了解原理后，你可以非常容易编写出相关代码。</p>
</li>
<li><p>本文写的都是一些耳熟能详的东西，目前决定写完幻影坦克、无影坦克及图像抖动。</p>
</li>
<li><p>本文可能出现大量自定义的术语，可能存在相关的术语，但是我懒得考究。</p>
</li>
<li>本文的颜色采用张量表示，采用爱因斯坦求和约定。</li>
<li>相关的C语言代码开源在<a target="_blank" rel="noopener" href="https://github.com/Ductory/ducklib">Ductory/ducklib: C libs (github.com)</a>，采用Windows原生的Gdiplus（直接从高中写的VB6代码移植）。</li>
</ol>
<h2 id="幻影坦克"><a href="#幻影坦克" class="headerlink" title="幻影坦克"></a>幻影坦克</h2><h3 id="约定"><a href="#约定" class="headerlink" title="约定"></a>约定</h3><ol>
<li><p>所有颜色分量和alpha的取值均归一化。</p>
</li>
<li><p>像素将用RGB格式表示，alpha单独讨论。</p>
</li>
</ol>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>幻影坦克事实上就是生成一张双层图（半透明图），使其在不同颜色的背景（通常是白色和黑色）下能显示出不同的内容。对于半透明图片，一般采用线性插值的方式计算其显示像素<sup><a href="#fn_1" id="reffn_1">1</a></sup>：</p>
<script type="math/tex; mode=display">
C_m=C_f\alpha+C_b(1-\alpha)</script><p>其中，$C_m$为图片混合后的像素，$C_f$为图片的实际像素，$C_b$为背景颜色。</p>
<p>当图片在白色背景下显示时，我们将其称为表图($S$)。当图片在黑色背景下显示时，我们将其称为里图($H$)。最后我们生成一张半透明的图片，我们将其称为混合图($M$)。</p>
<p>为何将白色背景显示的图片称为表图呢？以贴吧为例，一般用户不会打开深色模式，故图片默认以白色背景显示，点击后才会以黑色背景显示。</p>
<p>故而，我们便知道了深色模式无法查看幻影坦克的原因：倘若你打开了深色模式，默认便以黑色背景显示，显示出来的直接就是里图，也就看不到表图了。</p>
<p>需要注意的是，微信显示图片时始终使用白色背景，因此无法显示里图<sup><a href="#fn_2" id="reffn_2">2</a></sup>。</p>
<h3 id="灰度幻影坦克"><a href="#灰度幻影坦克" class="headerlink" title="灰度幻影坦克"></a>灰度幻影坦克</h3><p>接下来我们将由浅入深地讲解幻影坦克。先从最常见也最为简单的灰度幻影坦克讲起。</p>
<p>在理想的情况下，我们应当有如下关系<sup><a href="#fn_1" id="reffn_1">1</a></sup>：</p>
<script type="math/tex; mode=display">
S=M\alpha+1\cdot(1-\alpha) \\
H=M\alpha+0\cdot(1-\alpha)</script><p>故有：</p>
<script type="math/tex; mode=display">
\begin{aligned}
\alpha&=1-S+H\\
M&=\frac H \alpha
\end{aligned}</script><p>由于$\alpha \in [0,1]$，故应当有$S\geqslant H$。倘若$H&gt;S$，则$\alpha$只能取到1，从而得到$M=H$。这也就是说，在表图中会将里图的内容显示出来。为了避免此情况的发生，我们需要尽可能地增大$S$而减小$H$。而这便是为何幻影坦克常常是表图亮而里图暗的原因。</p>
<p>由于我们更关注里图，不妨来讨论一种特殊情况，即表图为全白，亦即，$S\equiv 1$。此时，$\alpha=H,M=1$，即表图仍是全白，而且我们可以做到无损地隐藏里图。</p>
<h3 id="更进一步"><a href="#更进一步" class="headerlink" title="更进一步"></a>更进一步</h3><p>让我们来考虑全彩的幻影坦克。这也是比较常见的，譬如朝夕图。此时，由于每个像素点有三个分量(r, g, b)，为了简洁起见，我们使用张量来表示，即</p>
<script type="math/tex; mode=display">
C_i,i=r,g,b</script><p>类似灰度幻影坦克，我们不难得到：</p>
<script type="math/tex; mode=display">
S_i=M_i\alpha_i+1\cdot(1-\alpha_i)\\
H_i=M_i\alpha_i+0\cdot(1-\alpha_i)</script><p>这看起来似乎和我们上文讲的没有任何区别。但实际上，对于每个像素，我们只有一个alpha通道而非三个，因此，我们只能有标量$\alpha’$而非张量$\alpha_i$。上面给出的理想公式是无法做到的。</p>
<h3 id="全彩幻影坦克"><a href="#全彩幻影坦克" class="headerlink" title="全彩幻影坦克"></a>全彩幻影坦克</h3><p>接下来考虑双图。相较于灰度幻影坦克，全彩的情况会稍稍更复杂一些。为了助于理解，我们将用这两张图来作为例子进行讲解。</p>
<p><img src="s.jpg" alt="表图"></p>
<p><img src="h.jpg" alt="里图"></p>
<p>正如上文所说，全彩幻影坦克的理想公式是无法做到的。因此，我们只能退而求其次，尝试生成一张混合图$M’$（其在白色背景下显示为$S’$，在黑色背景下显示为$H’$），使得$S’$和$S$以及$H’$和$H$尽可能接近。为简单起见，我们先在RGB空间下讨论。</p>
<p>我们采用RGB空间下的欧拉距离$\mathcal D_{RGB}(A, B)=\sqrt{(A_i-B_i)^2}$来评估两种颜色的差距，并这样评估混合图的效果：$\mathcal E=\mathcal D^2(S’, S)+\mathcal D^2(H’, H)$。</p>
<p>类似的，我们有如下公式：</p>
<script type="math/tex; mode=display">
\begin{aligned}
S'_i&=\alpha'M'_i+1-\alpha'\\
H'_i&=\alpha'M'_i
\end{aligned}</script><p>由于$S’_i$、$H’_i$、$M’_i$均是未知的，这给我们求解带来了很大困难，我们不得不做近似。我们记$\mathcal E_A,\alpha’_A$为在$A’\approx A,A=S,H,M$的条件下。故有</p>
<script type="math/tex; mode=display">
\begin{aligned}
\mathcal E_M&=(M_i-1)^2(\alpha'-\alpha_i)^2+M_i^2(\alpha'-\alpha_i)^2 \\
&=[M_i^2+(M_i-1)^2](\alpha'-\alpha_i)^2 \\
\end{aligned}</script><p>要让$\mathcal E$尽量小，则要有</p>
<script type="math/tex; mode=display">
\text d_{\alpha'}\mathcal E=2[M_i^2+(M_i-1)^2](\alpha'-\alpha_i)=0</script><p>故</p>
<script type="math/tex; mode=display">
\alpha'_M=\frac {[M_i^2+(M_i-1)^2]\alpha_i} {M_i^2+(M_i-1)^2}
=\frac {[H_i^2+(H_i-\alpha_i)^2]\alpha_i} {H_i^2+(H_i-\alpha_i)^2} \tag{1}</script><p>同样的，我们可以推出：</p>
<script type="math/tex; mode=display">
\alpha'_S=\alpha'_H=\bar{\alpha_i} \tag{2}</script><p>公式$(2)$较为平凡，因此让我们基于公式$(1)$生成一张混合图。检查效果，还是较为不错的。</p>
<p><img src="rgb.png" alt="rgb"></p>
<p>接下来我们关注一下细节。注意山峰，被阳光照射的雪看不见了。让我们来进行分析。我们给出：</p>
<p>$S_r&gt;&gt;H_r,S_g&gt;&gt;H_g,S_b&lt;H_b$。同时，我们有$\alpha_r\approx\alpha_g\approx 0.5,\alpha_b=1$。</p>
<p>不难注意到，蓝色分量的权重远大于另外两者，于是我们得到了较大的$\alpha’$。又$M_i={H_i} / {\alpha’}$，因此$M_r$, $M_g$较小，$M_b$较大，故而最终呈现出了蓝色的山顶，且白天和夜晚的山顶差别并不大。对于白天亮灯的情况也可以类似地进行分析。要想给出更好的显示效果，必须要让此处的$\alpha_i$尽可能小，因此，我们要$S_i$尽可能大于$H_i$，这就类似于我们在灰度图中讨论的了。</p>
<h3 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h3><p>接下来我们讨论如何预处理表图和里图，使得生成的混合图能够拥有更好的效果。事实上，灰度幻影坦克也可以预处理表图和里图，只需将其每个灰度值直接乘上一个因子即可。要让表图变亮，那么只需因子大于1；要让里图变暗，只需因子小于1。那么对于全彩的情况，我们是否可以这样操作呢？可以，但是我们可以看到，有时候效果并不好。当因子缩放过度时，很容易遇到$\alpha’$过小的情况，此时，表图中的这些位置全白，里图中的这些位置全黑，非常影响观感。我们可以采用另一种处理方法：$C’_i=G+c(C_i-G)$。其中，$G$为像素的灰度，$c$为因子。如此一来，里图的分量会向其灰度靠近，而表图则是偏离。虽说这样可以一定程度上减缓上述情况，但是，这种方法的效果实在是一言难尽。是一种更优的方案是将RGB空间转为HLS空间，并在HLS空间增大/减小亮度后转回RGB空间。但事实上，即便不进行预处理，效果也已经不错了，毕竟色彩空间转来转去也很麻烦。</p>
<h3 id="更优的全彩幻影坦克"><a href="#更优的全彩幻影坦克" class="headerlink" title="更优的全彩幻影坦克"></a>更优的全彩幻影坦克</h3><p>接下来我们更进一步，我们之前在RGB空间中来评估效果，现在我们在Lab空间来评估。</p>
<p>说是在Lab空间，但也没有完全在，因为在Lab空间分析实在太吃力。我们采用RGB空间下的近似公式（即加权欧几里得距离公式）<sup><a href="#fn_3" id="reffn_3">3</a></sup>：</p>
<script type="math/tex; mode=display">
\bar{r}=\frac {A_r+B_r} {2} \\
\Delta R=A_r-B_r\\
\Delta G=A_g-B_g\\
\Delta B=A_b-B_b\\
\mathcal D_{Lab}=\sqrt{(2+\frac{\bar{r}}{256})\Delta R^2+4\Delta G^2+(2+\frac{255-\bar{r}}{256})\Delta B^2}</script><p>我们这样评估混合图的效果：$\mathcal E=\mathcal D^2(S’, S)+\mathcal D^2(H’, H)$。</p>
<p>我们先计算$\mathcal E_H$。记</p>
<script type="math/tex; mode=display">
\Delta r=H_r-S_r\\
\Delta g=H_g-S_g\\
\Delta b=H_b-S_b\\
\tilde{\alpha}=1-\alpha'\\
\bar{r}=\frac {S_r'+S_r} {2}=\frac{H_r+S_r+\tilde{\alpha}}{2} \\
\Delta R=S_r'-S_r=\Delta r+\tilde{\alpha}\\
\Delta G=S_g'-S_g=\Delta g+\tilde{\alpha}\\
\Delta B=S_b'-S_b=\Delta b+\tilde{\alpha}</script><p>同样的，我们要有：</p>
<script type="math/tex; mode=display">
\begin{aligned}
\text d_{\alpha'}\mathcal E_H&=-[\frac 1 {512}(\Delta R^2-\Delta B^2)+\frac {\bar{r}}{128}(\Delta R-\Delta B)+4\Delta R+8\Delta G+5\frac {127}{128}\Delta B]\\
&=-[\frac 1{512}(\Delta r^2+2\Delta r\tilde{\alpha}-\Delta b^2-2\Delta b\tilde{\alpha})+\frac{H_r+S_r+\tilde{\alpha}}{256}(\Delta r-\Delta b)+4\Delta r+8\Delta g+5\frac {127}{128}\Delta b+17\frac{127}{128}\tilde{\alpha}]\\
&=-[\underbrace{\frac 1{128}(\Delta r-\Delta b)+17\frac{127}{128}}_A]\tilde{\alpha}-[\underbrace{\frac 1{512}(\Delta r^2-\Delta b^2)+\frac{H_r+S_r}{256}(\Delta r-\Delta b)+4\Delta r+8\Delta g+5\frac {127}{128}\Delta b}_B]\\
&=0
\end{aligned}</script><p>故有</p>
<script type="math/tex; mode=display">
\tilde{\alpha}=-\frac B A</script><p>或</p>
<script type="math/tex; mode=display">
\alpha'_H=1+\frac B A \tag{3}</script><p>同样的，</p>
<script type="math/tex; mode=display">
\begin{aligned}
\text d_{\alpha'}\mathcal E_S&=\frac 1 {512}(\Delta R^2-\Delta B^2)+\frac {\bar{r}}{128}(\Delta R-\Delta B)+4\Delta R+8\Delta G+5\frac {127}{128}\Delta B \\
&=\frac 1 {512}(\alpha_r^2-2\alpha_r\alpha'-\alpha_b^2+2\alpha_b\alpha')-\frac {2H_r+\alpha'-\alpha_r}{256}(\alpha_r-\alpha_b)+17\frac{127}{128}\alpha'-4\alpha_r-8\alpha_g-5\frac{127}{128}\alpha_b\\
&=-[\underbrace{\frac 1 {128}(\alpha_r-\alpha_b)-17\frac{127}{128}}_A]\alpha'-[\underbrace{-\frac 1 {512}(\alpha_r^2-\alpha_b^2)+\frac{2H_r-\alpha_r}{256}(\alpha_r-\alpha_b)+4\alpha_r+8\alpha_g+5\frac{127}{128}\alpha_b}_B]\\
&=0
\end{aligned}</script><p>有</p>
<script type="math/tex; mode=display">
\alpha'_S=-\frac B A \tag{4}</script><p>至于$M’\approx M$的情况，处理方法也是类似的，不过结果将会十分复杂，这里就不推导了。</p>
<p>我们使用公式$(3)$来生成一张混合图。</p>
<p><img src="lab.png" alt="lab"></p>
<p>可以看到，此算法的效果略好于$(1)$的算法，但事实上也不会好多少，因为每个像素只能共享一个alpha通道制约了它的上限。</p>
<h3 id="无表全彩"><a href="#无表全彩" class="headerlink" title="无表全彩"></a>无表全彩</h3><p>我们考虑一种特殊情况。类似灰度幻坦部分说的表图为全白的情况，假设我们完全不在乎表图的表现，而只期待里图能得到较好的显示效果。注意，我们的目的不是让里图得到最优的显示效果，因为显而易见的，这会得到$M_i=H_i,\alpha’=1$的结果，这便毫无意义了。</p>
<p>这种情况可以用来处理全彩的涩图和剑阵图，能在一定程度上防止其被吞。我们采用一种朴素的算法，即令$\alpha’=\max{\alpha_i}$，此时有$M’_i=H_i / \alpha’$。这只是一种经验公式，并不代表它有着最优的效果。$M’_i$和$M_i$会比较接近，但混合图偏暗一些。</p>
<h3 id="实例：基于全彩幻坦的二维码图像"><a href="#实例：基于全彩幻坦的二维码图像" class="headerlink" title="实例：基于全彩幻坦的二维码图像"></a>实例：基于全彩幻坦的二维码图像</h3><p>详细描述请见参考文献<sup><a href="#fn_2" id="reffn_2">2</a></sup>。我们翻译一下：$\min \mathcal E,\mathcal E\equiv \mathcal D^2(S’,S)$。</p>
<p>事实上，我们已经给出了公式，RGB空间和Lab空间下的$\alpha’_H$就是我们需要求的。</p>
<p>对于RGB空间，我们可以推导一下$\alpha’_M$，因为这与上文的结果不同。</p>
<script type="math/tex; mode=display">
\text d_{\alpha'}\mathcal E_M=2(M_i-1)^2(\alpha'-\alpha_i)=0</script><p>故</p>
<script type="math/tex; mode=display">
\alpha'_M=\frac {(M_i-1)^2\alpha_i}{(M_i-1)^2}=\frac {(H_i-\alpha_i)^2\alpha_i}{(H_i-\alpha_i)^2}</script><h2 id="无影坦克"><a href="#无影坦克" class="headerlink" title="无影坦克"></a>无影坦克</h2><h3 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h3><p>无影坦克实际上是<strong>最低有效位</strong>(Least Significant Bit, LSB)算法的民间称呼。这是一种图像隐写技术，由于人眼分辨能力有限，我们很难注意到细微的差别。因此很容易产生这一想法：改变像素点每个分量的最低位（或若干个低位），并将其用于存储额外的数据，而产生的细微变化不会被人眼所察觉<sup><a href="#fn_4" id="reffn_4">4</a></sup><sup><a href="#fn_5" id="reffn_5">5</a></sup>。</p>
<h3 id="缺陷"><a href="#缺陷" class="headerlink" title="缺陷"></a>缺陷</h3><p>我们可以注意到，无影坦克的鲁棒性是非常糟糕的。只有我们获取的是原图，我们才能正确地进行解码（现形）；但凡图片被平台稍加处理，譬如压缩或添加水印，我们隐写的数据便会面目全非。糟糕的是，无影坦克的生存空间正在不断缩小。放眼当今互联网，已经很难有什么平台不会对你的图片进行二次加工。</p>
<p>此外，无影坦克的信息密度很低。由于我们只能使用每个分量的最低位（或若干个低位）来存储数据，因此我们不能隐写大量的数据，所以无影坦克通常用来隐写种子、磁力、小图等少量数据。</p>
<p>最后，幻影坦克并没有一个统一的标准。当我们隐写数据时，我们显然要加上一个元数据来指明隐写数据的相关信息。然而，对于这个数据组织方式并没有一个公开的统一标准文档。尽管大量开发者尽可能去遵循同一约定，但该怎么隐写仍是一家之言，在发送张无影坦克图时也得带上相应的解码工具/网址，否则便可能无法正确解码。</p>
<h3 id="推荐标准"><a href="#推荐标准" class="headerlink" title="推荐标准"></a>推荐标准</h3><p>目前一般采用如下标准<sup><a href="#fn_6" id="reffn_6">6</a></sup>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">magic  ; data[0]&#123;0-2&#125;==0, data[1]&#123;0-2&#125;==3, data[2]&#123;0-2&#125;为每字节填充比特数(1~4)</span><br><span class="line">file_size: String</span><br><span class="line">\x01</span><br><span class="line">file_name: String</span><br><span class="line">\x01</span><br><span class="line">file_type: String</span><br><span class="line">\x00</span><br><span class="line"></span><br><span class="line">读写字节时队列向左增长，不使用alpha</span><br><span class="line">e.g. decode</span><br><span class="line">xxxxx110 xxxxx101 xxxxx001 alpha xxxxx010 ...</span><br><span class="line">   [        ] queue 110 &lt; 101 &lt; 001 &lt; 010 ...</span><br><span class="line">=&gt; [11010100] queue 1 &lt; 010 ...</span><br></pre></td></tr></table></figure>
<p>不过，由于大部分情况下我们并不关心文件名，而常用的文件类型可以直接给一个特定的值，我们可以对其优化：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">magic: data[0]&#123;0-2&#125;==1, data[1]&#123;0-1&#125;==2, data[2]&#123;0-1&#125;==每字节填充比特数-1, data[2]&#123;2&#125;==&#123;0: 不用alpha, 1: 使用alpha&#125;</span><br><span class="line">type: BYTE  ; 文件类型，见表</span><br><span class="line">flag: BYTE  ; 见表</span><br><span class="line">size: UINT  ; 文件大小</span><br><span class="line">[</span><br><span class="line">opt_data: VAR   ; 扩展头</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>其中，</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">值</th>
<th style="text-align:center">类型</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">unknown</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">text</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">bmp</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">jpeg</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">gif</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">tiff</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">png</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">webp</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">zip</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">7z</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">torrent</td>
</tr>
<tr>
<td style="text-align:center">11-255</td>
<td style="text-align:center">自定义</td>
</tr>
</tbody>
</table>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">标志</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">{0}</td>
<td style="text-align:center">启用扩展头</td>
</tr>
<tr>
<td style="text-align:center">{1-7}</td>
<td style="text-align:center">自定义</td>
</tr>
</tbody>
</table>
</div>
<h2 id="图像抖动"><a href="#图像抖动" class="headerlink" title="图像抖动"></a>图像抖动</h2><h3 id="简介-2"><a href="#简介-2" class="headerlink" title="简介"></a>简介</h3><p>我们知道，当图像的颜色深度较低时，每个像素可以表示的颜色数量有限，这可能会导致严重的颜色带状现象和颜色失真。</p>
<p>而图像抖动算法的核心思想是通过在图像中引入一些噪声，并将噪声扩散到相邻部分来近似，使得在视觉上能够模拟出更多的颜色（人眼将扩散感知为混合色）。例如，在黑白打印机或只有黑白显示能力的设备中，通过抖动算法可以产生不同灰度级别的效果<sup><a href="#fn_7" id="reffn_7">7</a></sup><sup><a href="#fn_8" id="reffn_8">8</a></sup>。</p>
<p>事实上，图像抖动有非常多的算法，比如有序抖动、随机抖动等等。在这里我们主要讲讲有序抖动和Floyd-Steinberg抖动算法。为了助于理解，我们将用这张图来作为例子进行讲解。</p>
<p><img src="duck.jpg" alt="duck"></p>
<h3 id="灰度图像抖动"><a href="#灰度图像抖动" class="headerlink" title="灰度图像抖动"></a>灰度图像抖动</h3><h4 id="有序抖动"><a href="#有序抖动" class="headerlink" title="有序抖动"></a>有序抖动</h4><p>倘若我们直接简单粗暴地进行二值化，我们将得到以下结果：</p>
<p><img src="bin.png" alt="bin"></p>
<p>我们可以看到，它丢失了很多细节，譬如阴影等。接下来让我们用有序抖动来进行抖动处理。</p>
<p>该算法通过将阈值图应用于显示的像素来减少颜色数，这里我们采用Bayer矩阵，它这样计算<sup><a href="#fn_9" id="reffn_9">9</a></sup>：</p>
<script type="math/tex; mode=display">
\begin{aligned}
M_1&=O\\
M_{2n}&=\frac 1 {(2n)^2}\times\begin{bmatrix}
(2n)^2\times M_n & (2n)^2\times M_n+2U \\ 
(2n)^2\times M_n+3U & (2n)^2\times M_n+U
\end{bmatrix}
\end{aligned}</script><p>其中，$O$为零矩阵，$U$为全1矩阵。</p>
<p>让我们用该算法来生成图片，可以得到如下结果：</p>
<p><img src="bayer.png" alt="bayer"></p>
<p>这仍然是一张二值图像，但是人眼看上去却像一张灰度图像。我们用两种颜色模拟出了更多的颜色，这就是抖动的有趣之处。</p>
<h4 id="Floyd-Steinberg算法"><a href="#Floyd-Steinberg算法" class="headerlink" title="Floyd-Steinberg算法"></a>Floyd-Steinberg算法</h4><p>接下来我们介绍一下Floyd-Steinberg算法。这种算法基于误差扩散来实现抖动，将像素点量化误差加到相邻像素上以便后续处理。</p>
<p>误差通过以下方式加权扩散<sup><a href="#fn_10" id="reffn_10">10</a></sup>：</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
&& * & \frac{7}{16} & \cdots \\
\cdots & \frac{3}{16} &  \frac{5}{16} & \frac{1}{16} & \cdots
\end{bmatrix}</script><p>其中，*表示当前正在扫描的像素，空白为先前扫描的像素，其余部分为扩散的权重。</p>
<p>让我们用该算法来处理一下：</p>
<p><img src="fs.png" alt="fs"></p>
<p>可以看到，效果也很不错。</p>
<h3 id="全彩图像抖动"><a href="#全彩图像抖动" class="headerlink" title="全彩图像抖动"></a>全彩图像抖动</h3><p>相较于灰度图，全彩图有RGB三个分量。要使用Floyd-Steinberg算法，只需每个分量分别处理即可。</p>
<p>我们主要讨论一下固定色表的全彩抖动，采用某游戏的16种羊毛色来作为色表。此时我们需要用最近邻搜索来查找色表中的哪种颜色与我们当前像素的颜色最为接近。由于颜色较少，即便使用暴力搜索也未尝不可。评估方法不再赘述，在幻影坦克部分已经给出。我们得到了以下图像：</p>
<p><img src="fs2.png" alt="fs2"></p>
<p>我们可以看到有些部分明显变色了。这是因为这张色表并不是一张好的色表，它所能覆盖的区域太小了。当有一片表外颜色的像素出现时，误差会越积越多，以至于所造成的影响远大于原像素，最后严重破坏了表现效果。</p>
<p>为了解决这一问题，我们可以采用一种非常简单的处理方法：确保当前颜色在我们设定的阈值之内。如此处理后，我们得到了如下图像：</p>
<p><img src="fs3.png" alt="fs3"></p>
<p>我们可以看到，这个问题被较好地解决了。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文对于三种算法的讨论都是浅尝辄止，事实上，每种算法都有着相当丰富的内容，感兴趣的读者可以自行搜索学习。</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p><sup><a href="#fn_1" id="reffn_1">1</a></sup>:偶尔有点小迷糊. (2021, March 8). 『整活』幻影坦克 基础版 [video]. Bilibili. <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1kV411v7fR">https://www.bilibili.com/video/BV1kV411v7fR</a><br><sup><a href="#fn_2" id="reffn_2">2</a></sup>:偶尔有点小迷糊. (2024, March 25). 【揭秘】在任意图片中隐藏二维码 肉眼不可见但微信可扫 [video]. Bilibili. <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Yu4m1T7B8">https://www.bilibili.com/video/BV1Yu4m1T7B8</a><br><sup><a href="#fn_3" id="reffn_3">3</a></sup>: Riemersma, T. (2019). Colour metric. CompuPhase. <a target="_blank" rel="noopener" href="https://www.compuphase.com/cmetric.htm">Colour metric (compuphase.com)</a><br><sup><a href="#fn_4" id="reffn_4">4</a></sup>:偶尔有点小迷糊. (2021, May 28). 『整活』建议改为：图片套娃 [video]. Bilibili. <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Vv411V7Yo">https://www.bilibili.com/video/BV1Vv411V7Yo</a><br><sup><a href="#fn_5" id="reffn_5">5</a></sup>:Ele实验室. (2022, February 24). 隐写术鉴赏 [video]. Bilibili. <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Su411X7vY">https://www.bilibili.com/video/BV1Su411X7vY</a></p>
<p><sup><a href="#fn_7" id="reffn_7">7</a></sup>:oooooohmygosh. (2021, June 23). 你能把两个色块拼成渐变色吗？- oooooohmygosh [video]. Bilibili. <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Kb4y1C7fo">https://www.bilibili.com/video/BV1Kb4y1C7fo</a><br><sup><a href="#fn_8" id="reffn_8">8</a></sup>:Wikipedia contributors. (n.d.). Dither. Wikipedia. Retrived March 30, 2024. <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Dither">Dither - Wikipedia</a><br><sup><a href="#fn_9" id="reffn_9">9</a></sup>:Wikipedia contributors. (n.d.). Ordered dithering. Wikipedia. Retrived March 30, 2024. <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Ordered_dithering">Ordered dithering - Wikipedia</a><br><sup><a href="#fn_10" id="reffn_10">10</a></sup>:Wikipedia contributors. (n.d.). Floyd–Steinberg dithering. Wikipedia. Retrived March 30, 2024. <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Floyd–Steinberg_dithering">Floyd–Steinberg dithering - Wikipedia</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://ductory.github.io/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/" data-id="clo5r4yb60006jcf5byu26311" data-title="浅谈一些有趣的图像处理算法" class="article-share-link">Share</a>
      
      
        <a href="/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/#comments" class="article-comment-link">
          <span class="post-comments-count valine-comment-count" data-xid="/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/" itemprop="commentCount"></span>
          Comments
        </a>
      
      
  
    <a class="article-view-link">
      <span id="busuanzi_value_page_pv"></span>
      Times
    </a>
  
  

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C</a></li></ul>

    </footer>
  </div>
  
    
      <div id="toc" style="visibility:hidden">
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B9%BB%E5%BD%B1%E5%9D%A6%E5%85%8B"><span class="toc-text">幻影坦克</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%A6%E5%AE%9A"><span class="toc-text">约定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%81%B0%E5%BA%A6%E5%B9%BB%E5%BD%B1%E5%9D%A6%E5%85%8B"><span class="toc-text">灰度幻影坦克</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E8%BF%9B%E4%B8%80%E6%AD%A5"><span class="toc-text">更进一步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%BD%A9%E5%B9%BB%E5%BD%B1%E5%9D%A6%E5%85%8B"><span class="toc-text">全彩幻影坦克</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-text">预处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E4%BC%98%E7%9A%84%E5%85%A8%E5%BD%A9%E5%B9%BB%E5%BD%B1%E5%9D%A6%E5%85%8B"><span class="toc-text">更优的全彩幻影坦克</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E8%A1%A8%E5%85%A8%E5%BD%A9"><span class="toc-text">无表全彩</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%EF%BC%9A%E5%9F%BA%E4%BA%8E%E5%85%A8%E5%BD%A9%E5%B9%BB%E5%9D%A6%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%A0%81%E5%9B%BE%E5%83%8F"><span class="toc-text">实例：基于全彩幻坦的二维码图像</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E5%BD%B1%E5%9D%A6%E5%85%8B"><span class="toc-text">无影坦克</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-1"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E9%99%B7"><span class="toc-text">缺陷</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A8%E8%8D%90%E6%A0%87%E5%87%86"><span class="toc-text">推荐标准</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E5%83%8F%E6%8A%96%E5%8A%A8"><span class="toc-text">图像抖动</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-2"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%81%B0%E5%BA%A6%E5%9B%BE%E5%83%8F%E6%8A%96%E5%8A%A8"><span class="toc-text">灰度图像抖动</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%89%E5%BA%8F%E6%8A%96%E5%8A%A8"><span class="toc-text">有序抖动</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Floyd-Steinberg%E7%AE%97%E6%B3%95"><span class="toc-text">Floyd-Steinberg算法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%BD%A9%E5%9B%BE%E5%83%8F%E6%8A%96%E5%8A%A8"><span class="toc-text">全彩图像抖动</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="toc-text">参考文献</span></a></li></ol>
</div>
    
    
<nav id="article-nav">
  
    <a href="/2023/11/19/%E8%AE%A9tcc%E7%94%A8%E4%B8%8ASEH/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          让tcc用上SEH
        
      </div>
    </a>
  
  
    <a href="/2023/05/01/build-your-own-blog/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">浅谈个人博客搭建</div>
    </a>
  
</nav>

  
</article>



  <section id="comments" class="vcomment">

  </section>
</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/C/" style="font-size: 20px;">C</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">October 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/11/19/%E8%AE%A9tcc%E7%94%A8%E4%B8%8ASEH/">让tcc用上SEH</a>
          </li>
        
          <li>
            <a href="/2023/10/25/%E6%B5%85%E8%B0%88%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/">浅谈一些有趣的图像处理算法</a>
          </li>
        
          <li>
            <a href="/2023/05/01/build-your-own-blog/">浅谈个人博客搭建</a>
          </li>
        
          <li>
            <a href="/2022/12/26/C%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8-%E8%AF%BB%E5%8F%96%E5%8F%98%E9%87%8F%E7%9A%84%E5%80%BC/">C语言入门 读取变量的值</a>
          </li>
        
          <li>
            <a href="/2022/12/26/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div id="toc-div" class="widget-wrap" style="visibility:hidden">
  <h3 class="widget-title">Content</h3>
  <div class="widget"></div>
</div>
  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 Dangfer | Licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">BY-SA 4.0</a><br>
      
  
  
    View <span id="busuanzi_value_site_pv"></span> times,
    <span id="busuanzi_value_site_uv"></span> visitors in total.<br>
  

      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  
<script src="https://unpkg.com/valine@1.5.1/dist/Valine.min.js"></script>

<script>
    var GUEST_INFO = ['nick','mail','link'];
    var guest_info = 'nick,mail,link'.split(',').filter(function(item){
        return GUEST_INFO.indexOf(item) > -1
    });
    var notify = 'false' == true;
    var verify = 'false' == true;
    new Valine({
        el: '.vcomment',
        notify: notify,
        verify: verify,
        appId: "7KBOykQi5QpBlpD3fdDjybuz-9Nh9j0Va",
        appKey: "3Odm0iQjCZ0FtFlNZAqACXqq",
        placeholder: "Say something...",
        pageSize:'10',
        avatar:'mm',
        lang:'zh-cn',
        serverURLs: 'https://7kboykqi.lc-cn-n1-shared.com'
    });
</script>



  
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




<script src="/js/toc.js"></script>

  </div>
</body>
</html>